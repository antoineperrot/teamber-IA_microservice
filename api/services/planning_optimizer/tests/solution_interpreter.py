"""
Module de test de la traduction de la solution mathématique en une sortie DataFrame interprétable.
"""

import unittest
import pandas as pd
from api.services.planning_optimizer.solver.planning.solution_interpreter import get_next_part, add_event,\
    move_indexes_forward, make_events


class TestSolutionInterpreter(unittest.TestCase):
    def setUp(self):
        self.parts = pd.DataFrame.from_dict({'start': {0: pd.Timestamp('2022-09-05 09:30:00+0000', tz='UTC'),
  1: pd.Timestamp('2022-09-05 11:30:00+0000', tz='UTC'),
  2: pd.Timestamp('2022-09-05 12:30:00+0000', tz='UTC'),
  3: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
  4: pd.Timestamp('2022-09-05 14:00:00+0000', tz='UTC'),
  5: pd.Timestamp('2022-09-06 06:30:00+0000', tz='UTC'),
  6: pd.Timestamp('2022-09-06 07:30:00+0000', tz='UTC'),
  7: pd.Timestamp('2022-09-06 08:30:00+0000', tz='UTC'),
  8: pd.Timestamp('2022-09-06 11:30:00+0000', tz='UTC'),
  9: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
  10: pd.Timestamp('2022-09-06 13:00:00+0000', tz='UTC'),
  11: pd.Timestamp('2022-09-06 14:00:00+0000', tz='UTC'),
  12: pd.Timestamp('2022-09-07 08:45:00+0000', tz='UTC'),
  13: pd.Timestamp('2022-09-07 09:45:00+0000', tz='UTC'),
  14: pd.Timestamp('2022-09-07 11:30:00+0000', tz='UTC'),
  15: pd.Timestamp('2022-09-07 12:30:00+0000', tz='UTC'),
  16: pd.Timestamp('2022-09-07 14:10:00+0000', tz='UTC'),
  17: pd.Timestamp('2022-09-08 06:30:00+0000', tz='UTC'),
  18: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
  19: pd.Timestamp('2022-09-08 07:45:00+0000', tz='UTC'),
  20: pd.Timestamp('2022-09-08 08:45:00+0000', tz='UTC'),
  21: pd.Timestamp('2022-09-08 10:30:00+0000', tz='UTC'),
  22: pd.Timestamp('2022-09-08 11:30:00+0000', tz='UTC'),
  23: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
  24: pd.Timestamp('2022-09-08 12:45:00+0000', tz='UTC'),
  25: pd.Timestamp('2022-09-08 13:00:00+0000', tz='UTC'),
  26: pd.Timestamp('2022-09-08 14:00:00+0000', tz='UTC'),
  27: pd.Timestamp('2022-09-09 07:00:00+0000', tz='UTC'),
  28: pd.Timestamp('2022-09-09 08:00:00+0000', tz='UTC'),
  29: pd.Timestamp('2022-09-09 09:00:00+0000', tz='UTC')},
                                             'end': {0: pd.Timestamp('2022-09-05 09:45:00+0000', tz='UTC'),
                                              1: pd.Timestamp('2022-09-05 12:30:00+0000', tz='UTC'),
                                              2: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
                                              3: pd.Timestamp('2022-09-05 14:00:00+0000', tz='UTC'),
                                              4: pd.Timestamp('2022-09-05 15:00:00+0000', tz='UTC'),
                                              5: pd.Timestamp('2022-09-06 07:30:00+0000', tz='UTC'),
                                              6: pd.Timestamp('2022-09-06 08:30:00+0000', tz='UTC'),
                                              7: pd.Timestamp('2022-09-06 09:00:00+0000', tz='UTC'),
                                              8: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
                                              9: pd.Timestamp('2022-09-06 13:00:00+0000', tz='UTC'),
                                              10: pd.Timestamp('2022-09-06 14:00:00+0000', tz='UTC'),
                                              11: pd.Timestamp('2022-09-06 15:00:00+0000', tz='UTC'),
                                              12: pd.Timestamp('2022-09-07 09:45:00+0000', tz='UTC'),
                                              13: pd.Timestamp('2022-09-07 10:15:00+0000', tz='UTC'),
                                              14: pd.Timestamp('2022-09-07 12:30:00+0000', tz='UTC'),
                                              15: pd.Timestamp('2022-09-07 12:45:00+0000', tz='UTC'),
                                              16: pd.Timestamp('2022-09-07 15:10:00+0000', tz='UTC'),
                                              17: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
                                              18: pd.Timestamp('2022-09-08 07:45:00+0000', tz='UTC'),
                                              19: pd.Timestamp('2022-09-08 08:45:00+0000', tz='UTC'),
                                              20: pd.Timestamp('2022-09-08 09:45:00+0000', tz='UTC'),
                                              21: pd.Timestamp('2022-09-08 11:30:00+0000', tz='UTC'),
                                              22: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
                                              23: pd.Timestamp('2022-09-08 12:45:00+0000', tz='UTC'),
                                              24: pd.Timestamp('2022-09-08 13:00:00+0000', tz='UTC'),
                                              25: pd.Timestamp('2022-09-08 14:00:00+0000', tz='UTC'),
                                              26: pd.Timestamp('2022-09-08 14:30:00+0000', tz='UTC'),
                                              27: pd.Timestamp('2022-09-09 08:00:00+0000', tz='UTC'),
                                              28: pd.Timestamp('2022-09-09 09:00:00+0000', tz='UTC'),
                                              29: pd.Timestamp('2022-09-09 10:00:00+0000', tz='UTC')},
                                             'evt_spkevenement': {0: 4661,
                                              1: 3620,
                                              2: 3620,
                                              3: 1592,
                                              4: 1592,
                                              5: 1592,
                                              6: 1592,
                                              7: 5639,
                                              8: 5639,
                                              9: 3607,
                                              10: 2550,
                                              11: 2550,
                                              12: 4476,
                                              13: 4476,
                                              14: 4661,
                                              15: 4661,
                                              16: 3607,
                                              17: 3607,
                                              18: 9367,
                                              19: 9367,
                                              20: 3347,
                                              21: 3347,
                                              22: 3347,
                                              23: 7112,
                                              24: 7112,
                                              25: 7112,
                                              26: 7112,
                                              27: 151,
                                              28: 1090,
                                              29: 1090},
                                             'evt_sfkprojet': {0: 4455,
                                              1: 8297,
                                              2: 8297,
                                              3: 8297,
                                              4: 8297,
                                              5: 8297,
                                              6: 8297,
                                              7: 8297,
                                              8: 8297,
                                              9: 1261,
                                              10: 4455,
                                              11: 4455,
                                              12: 4455,
                                              13: 4455,
                                              14: 4455,
                                              15: 4455,
                                              16: 1261,
                                              17: 1261,
                                              18: 1261,
                                              19: 1261,
                                              20: 7367,
                                              21: 7367,
                                              22: 7367,
                                              23: 7367,
                                              24: 7367,
                                              25: 7367,
                                              26: 7367,
                                              27: 6675,
                                              28: 9348,
                                              29: 9348},
                                             'priorite': {0: 2,
                                              1: 1,
                                              2: 1,
                                              3: 1,
                                              4: 1,
                                              5: 1,
                                              6: 1,
                                              7: 1,
                                              8: 1,
                                              9: 2,
                                              10: 2,
                                              11: 2,
                                              12: 2,
                                              13: 2,
                                              14: 2,
                                              15: 2,
                                              16: 2,
                                              17: 2,
                                              18: 2,
                                              19: 2,
                                              20: 3,
                                              21: 3,
                                              22: 3,
                                              23: 3,
                                              24: 3,
                                              25: 3,
                                              26: 3,
                                              27: 4,
                                              28: 4,
                                              29: 4}})

        self.parts2 = pd.DataFrame.from_dict({'start': {0: pd.Timestamp('2022-09-05 09:30:00+0000', tz='UTC'),
  1: pd.Timestamp('2022-09-05 11:30:00+0000', tz='UTC'),
  2: pd.Timestamp('2022-09-05 12:30:00+0000', tz='UTC'),
  3: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
  4: pd.Timestamp('2022-09-06 06:30:00+0000', tz='UTC'),
  5: pd.Timestamp('2022-09-06 07:30:00+0000', tz='UTC'),
  6: pd.Timestamp('2022-09-06 08:00:00+0000', tz='UTC'),
  7: pd.Timestamp('2022-09-06 11:30:00+0000', tz='UTC'),
  8: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
  9: pd.Timestamp('2022-09-06 13:30:00+0000', tz='UTC'),
  10: pd.Timestamp('2022-09-06 14:00:00+0000', tz='UTC'),
  11: pd.Timestamp('2022-09-07 08:45:00+0000', tz='UTC'),
  12: pd.Timestamp('2022-09-07 11:30:00+0000', tz='UTC'),
  13: pd.Timestamp('2022-09-07 14:10:00+0000', tz='UTC'),
  14: pd.Timestamp('2022-09-08 06:30:00+0000', tz='UTC'),
  15: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
  16: pd.Timestamp('2022-09-08 08:30:00+0000', tz='UTC'),
  17: pd.Timestamp('2022-09-08 09:30:00+0000', tz='UTC'),
  18: pd.Timestamp('2022-09-08 10:30:00+0000', tz='UTC'),
  19: pd.Timestamp('2022-09-08 11:30:00+0000', tz='UTC'),
  20: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
  21: pd.Timestamp('2022-09-08 13:30:00+0000', tz='UTC'),
  22: pd.Timestamp('2022-09-09 07:00:00+0000', tz='UTC'),
  23: pd.Timestamp('2022-09-09 07:30:00+0000', tz='UTC'),
  24: pd.Timestamp('2022-09-09 07:45:00+0000', tz='UTC'),
  25: pd.Timestamp('2022-09-09 08:45:00+0000', tz='UTC'),
  26: pd.Timestamp('2022-09-09 09:00:00+0000', tz='UTC')},
                                            'end': {0: pd.Timestamp('2022-09-05 10:00:00+0000', tz='UTC'),
                                          1: pd.Timestamp('2022-09-05 12:30:00+0000', tz='UTC'),
                                          2: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
                                          3: pd.Timestamp('2022-09-05 14:15:00+0000', tz='UTC'),
                                          4: pd.Timestamp('2022-09-06 07:30:00+0000', tz='UTC'),
                                          5: pd.Timestamp('2022-09-06 08:00:00+0000', tz='UTC'),
                                          6: pd.Timestamp('2022-09-06 09:00:00+0000', tz='UTC'),
                                          7: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
                                          8: pd.Timestamp('2022-09-06 13:30:00+0000', tz='UTC'),
                                          9: pd.Timestamp('2022-09-06 14:00:00+0000', tz='UTC'),
                                          10: pd.Timestamp('2022-09-06 15:00:00+0000', tz='UTC'),
                                          11: pd.Timestamp('2022-09-07 09:45:00+0000', tz='UTC'),
                                          12: pd.Timestamp('2022-09-07 12:30:00+0000', tz='UTC'),
                                          13: pd.Timestamp('2022-09-07 15:10:00+0000', tz='UTC'),
                                          14: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
                                          15: pd.Timestamp('2022-09-08 08:30:00+0000', tz='UTC'),
                                          16: pd.Timestamp('2022-09-08 09:30:00+0000', tz='UTC'),
                                          17: pd.Timestamp('2022-09-08 10:15:00+0000', tz='UTC'),
                                          18: pd.Timestamp('2022-09-08 11:30:00+0000', tz='UTC'),
                                          19: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
                                          20: pd.Timestamp('2022-09-08 13:30:00+0000', tz='UTC'),
                                          21: pd.Timestamp('2022-09-08 14:15:00+0000', tz='UTC'),
                                          22: pd.Timestamp('2022-09-09 07:30:00+0000', tz='UTC'),
                                          23: pd.Timestamp('2022-09-09 07:45:00+0000', tz='UTC'),
                                          24: pd.Timestamp('2022-09-09 08:45:00+0000', tz='UTC'),
                                          25: pd.Timestamp('2022-09-09 09:00:00+0000', tz='UTC'),
                                              26: pd.Timestamp('2022-09-09 10:00:00+0000', tz='UTC')},
                                             'evt_spkevenement': {0: 2920,
                                              1: 2920,
                                              2: 2920,
                                              3: 2920,
                                              4: 6412,
                                              5: 6412,
                                              6: 6412,
                                              7: 6412,
                                              8: 9371,
                                              9: 9371,
                                              10: 6838,
                                              11: 6838,
                                              12: 6838,
                                              13: 8373,
                                              14: 8626,
                                              15: 9458,
                                              16: 9458,
                                              17: 9458,
                                              18: 9458,
                                              19: 6688,
                                              20: 1182,
                                              21: 8318,
                                              22: 8318,
                                              23: 8318,
                                              24: 8318,
                                              25: 32,
                                              26: 32},
                                             'evt_sfkprojet': {0: 6648,
                                              1: 6648,
                                              2: 6648,
                                              3: 6648,
                                              4: 6648,
                                              5: 6648,
                                              6: 6648,
                                              7: 6648,
                                              8: 1778,
                                              9: 1778,
                                              10: 4361,
                                              11: 4361,
                                              12: 4361,
                                              13: 3768,
                                              14: 4361,
                                              15: 7923,
                                              16: 7923,
                                              17: 7923,
                                              18: 7923,
                                              19: 8702,
                                              20: 2304,
                                              21: 9528,
                                              22: 9528,
                                              23: 9528,
                                              24: 9528,
                                              25: 1805,
                                              26: 1805},
                                             'priorite': {0: 0,
                                              1: 0,
                                              2: 0,
                                              3: 0,
                                              4: 0,
                                              5: 0,
                                              6: 0,
                                              7: 0,
                                              8: 2,
                                              9: 2,
                                              10: 1,
                                              11: 1,
                                              12: 1,
                                              13: 2,
                                              14: 1,
                                              15: 2,
                                              16: 2,
                                              17: 2,
                                              18: 2,
                                              19: 3,
                                              20: 4,
                                              21: 4,
                                              22: 4,
                                              23: 4,
                                              24: 4,
                                              25: 4,
                                              26: 4}})

        self.make_events_input_1 = pd.DataFrame.copy(self.parts)
        self.make_events_expected_1 = pd.DataFrame.from_dict(
            {'start': {0: pd.Timestamp('2022-09-05 09:30:00+0000', tz='UTC'),
                       1: pd.Timestamp('2022-09-05 11:30:00+0000', tz='UTC'),
                       2: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
                       3: pd.Timestamp('2022-09-06 06:30:00+0000', tz='UTC'),
                       4: pd.Timestamp('2022-09-06 08:30:00+0000', tz='UTC'),
                       5: pd.Timestamp('2022-09-06 11:30:00+0000', tz='UTC'),
                       6: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
                       7: pd.Timestamp('2022-09-06 13:00:00+0000', tz='UTC'),
                       8: pd.Timestamp('2022-09-07 08:45:00+0000', tz='UTC'),
                       9: pd.Timestamp('2022-09-07 11:30:00+0000', tz='UTC'),
                       10: pd.Timestamp('2022-09-07 14:10:00+0000', tz='UTC'),
                       11: pd.Timestamp('2022-09-08 06:30:00+0000', tz='UTC'),
                       12: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
                       13: pd.Timestamp('2022-09-08 08:45:00+0000', tz='UTC'),
                       14: pd.Timestamp('2022-09-08 10:30:00+0000', tz='UTC'),
                       15: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
                       16: pd.Timestamp('2022-09-08 13:00:00+0000', tz='UTC'),
                       17: pd.Timestamp('2022-09-09 07:00:00+0000', tz='UTC'),
                       18: pd.Timestamp('2022-09-09 08:00:00+0000', tz='UTC')},
             'end': {0: pd.Timestamp('2022-09-05 09:45:00+0000', tz='UTC'),
                     1: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
                     2: pd.Timestamp('2022-09-05 15:00:00+0000', tz='UTC'),
                     3: pd.Timestamp('2022-09-06 08:30:00+0000', tz='UTC'),
                     4: pd.Timestamp('2022-09-06 09:00:00+0000', tz='UTC'),
                     5: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
                     6: pd.Timestamp('2022-09-06 13:00:00+0000', tz='UTC'),
                     7: pd.Timestamp('2022-09-06 15:00:00+0000', tz='UTC'),
                     8: pd.Timestamp('2022-09-07 10:15:00+0000', tz='UTC'),
                     9: pd.Timestamp('2022-09-07 12:45:00+0000', tz='UTC'),
                     10: pd.Timestamp('2022-09-07 15:10:00+0000', tz='UTC'),
                     11: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
                     12: pd.Timestamp('2022-09-08 08:45:00+0000', tz='UTC'),
                     13: pd.Timestamp('2022-09-08 09:45:00+0000', tz='UTC'),
                     14: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
                     15: pd.Timestamp('2022-09-08 13:00:00+0000', tz='UTC'),
                     16: pd.Timestamp('2022-09-08 14:30:00+0000', tz='UTC'),
                     17: pd.Timestamp('2022-09-09 08:00:00+0000', tz='UTC'),
                     18: pd.Timestamp('2022-09-09 10:00:00+0000', tz='UTC')},
             'evt_spkevenement': {0: 4661,
                                  1: 3620,
                                  2: 1592,
                                  3: 1592,
                                  4: 5639,
                                  5: 5639,
                                  6: 3607,
                                  7: 2550,
                                  8: 4476,
                                  9: 4661,
                                  10: 3607,
                                  11: 3607,
                                  12: 9367,
                                  13: 3347,
                                  14: 3347,
                                  15: 7112,
                                  16: 7112,
                                  17: 151,
                                  18: 1090},
             'evt_sfkprojet': {0: 4455,
                               1: 8297,
                               2: 8297,
                               3: 8297,
                               4: 8297,
                               5: 8297,
                               6: 1261,
                               7: 4455,
                               8: 4455,
                               9: 4455,
                               10: 1261,
                               11: 1261,
                               12: 1261,
                               13: 7367,
                               14: 7367,
                               15: 7367,
                               16: 7367,
                               17: 6675,
                               18: 9348},
             'priorite': {0: 2,
                          1: 1,
                          2: 1,
                          3: 1,
                          4: 1,
                          5: 1,
                          6: 2,
                          7: 2,
                          8: 2,
                          9: 2,
                          10: 2,
                          11: 2,
                          12: 2,
                          13: 3,
                          14: 3,
                          15: 3,
                          16: 3,
                          17: 4,
                          18: 4}})

        self.make_events_input_2 = pd.DataFrame.copy(self.parts[:-1])
        self.make_events_expected_2 = pd.DataFrame.from_dict(
            {'start': {0: pd.Timestamp('2022-09-05 09:30:00+0000', tz='UTC'),
                       1: pd.Timestamp('2022-09-05 11:30:00+0000', tz='UTC'),
                       2: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
                       3: pd.Timestamp('2022-09-06 06:30:00+0000', tz='UTC'),
                       4: pd.Timestamp('2022-09-06 08:30:00+0000', tz='UTC'),
                       5: pd.Timestamp('2022-09-06 11:30:00+0000', tz='UTC'),
                       6: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
                       7: pd.Timestamp('2022-09-06 13:00:00+0000', tz='UTC'),
                       8: pd.Timestamp('2022-09-07 08:45:00+0000', tz='UTC'),
                       9: pd.Timestamp('2022-09-07 11:30:00+0000', tz='UTC'),
                       10: pd.Timestamp('2022-09-07 14:10:00+0000', tz='UTC'),
                       11: pd.Timestamp('2022-09-08 06:30:00+0000', tz='UTC'),
                       12: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
                       13: pd.Timestamp('2022-09-08 08:45:00+0000', tz='UTC'),
                       14: pd.Timestamp('2022-09-08 10:30:00+0000', tz='UTC'),
                       15: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
                       16: pd.Timestamp('2022-09-08 13:00:00+0000', tz='UTC'),
                       17: pd.Timestamp('2022-09-09 07:00:00+0000', tz='UTC'),
                       18: pd.Timestamp('2022-09-09 08:00:00+0000', tz='UTC')},
             'end': {0: pd.Timestamp('2022-09-05 09:45:00+0000', tz='UTC'),
                     1: pd.Timestamp('2022-09-05 13:30:00+0000', tz='UTC'),
                     2: pd.Timestamp('2022-09-05 15:00:00+0000', tz='UTC'),
                     3: pd.Timestamp('2022-09-06 08:30:00+0000', tz='UTC'),
                     4: pd.Timestamp('2022-09-06 09:00:00+0000', tz='UTC'),
                     5: pd.Timestamp('2022-09-06 12:30:00+0000', tz='UTC'),
                     6: pd.Timestamp('2022-09-06 13:00:00+0000', tz='UTC'),
                     7: pd.Timestamp('2022-09-06 15:00:00+0000', tz='UTC'),
                     8: pd.Timestamp('2022-09-07 10:15:00+0000', tz='UTC'),
                     9: pd.Timestamp('2022-09-07 12:45:00+0000', tz='UTC'),
                     10: pd.Timestamp('2022-09-07 15:10:00+0000', tz='UTC'),
                     11: pd.Timestamp('2022-09-08 07:30:00+0000', tz='UTC'),
                     12: pd.Timestamp('2022-09-08 08:45:00+0000', tz='UTC'),
                     13: pd.Timestamp('2022-09-08 09:45:00+0000', tz='UTC'),
                     14: pd.Timestamp('2022-09-08 12:30:00+0000', tz='UTC'),
                     15: pd.Timestamp('2022-09-08 13:00:00+0000', tz='UTC'),
                     16: pd.Timestamp('2022-09-08 14:30:00+0000', tz='UTC'),
                     17: pd.Timestamp('2022-09-09 08:00:00+0000', tz='UTC'),
                     18: pd.Timestamp('2022-09-09 09:00:00+0000', tz='UTC')},
             'evt_spkevenement': {0: 4661,
                                  1: 3620,
                                  2: 1592,
                                  3: 1592,
                                  4: 5639,
                                  5: 5639,
                                  6: 3607,
                                  7: 2550,
                                  8: 4476,
                                  9: 4661,
                                  10: 3607,
                                  11: 3607,
                                  12: 9367,
                                  13: 3347,
                                  14: 3347,
                                  15: 7112,
                                  16: 7112,
                                  17: 151,
                                  18: 1090},
             'evt_sfkprojet': {0: 4455,
                               1: 8297,
                               2: 8297,
                               3: 8297,
                               4: 8297,
                               5: 8297,
                               6: 1261,
                               7: 4455,
                               8: 4455,
                               9: 4455,
                               10: 1261,
                               11: 1261,
                               12: 1261,
                               13: 7367,
                               14: 7367,
                               15: 7367,
                               16: 7367,
                               17: 6675,
                               18: 9348},
             'priorite': {0: 2,
                          1: 1,
                          2: 1,
                          3: 1,
                          4: 1,
                          5: 1,
                          6: 2,
                          7: 2,
                          8: 2,
                          9: 2,
                          10: 2,
                          11: 2,
                          12: 2,
                          13: 3,
                          14: 3,
                          15: 3,
                          16: 3,
                          17: 4,
                          18: 4}})


        self.events = add_event()

    def test_get_next_part(self):
        i_next_current_part = get_next_part(0, self.parts)
        self.assertEqual(1, i_next_current_part)

        i_next_current_part = get_next_part(1, self.parts)
        self.assertEqual(3, i_next_current_part)

        i_next_current_part = get_next_part(2, self.parts)
        self.assertEqual(3, i_next_current_part)

        i_next_current_part = get_next_part(5, self.parts)
        self.assertEqual(7, i_next_current_part)

        i_next_current_part = get_next_part(28, self.parts)
        self.assertEqual(30, i_next_current_part)

        i_next_current_part = get_next_part(29, self.parts)
        self.assertEqual(30, i_next_current_part)

    def test_add_event(self):
        expected = {'start': [pd.Timestamp('2022-09-05 09:30:00+0000', tz='UTC')],
                     'end': [pd.Timestamp('2022-09-05 09:45:00+0000', tz='UTC')],
                     'evt_spkevenement': [4661],
                     'evt_sfkprojet': [4455],
                     'priorite': [2]}

        output_func = add_event(self.parts, 0, 1, events=self.events)
        pd.testing.assert_frame_equal(pd.DataFrame.from_dict(expected), pd.DataFrame.from_dict(output_func))

    def test_move_indexes_forward(self):
        expected = (0, 1)
        output_func = move_indexes_forward(self.parts)
        self.assertEqual(expected, output_func)

        expected = (0, 0)
        output_func = move_indexes_forward(self.parts[:1])
        self.assertEqual(expected, output_func)

        expected = (2, 3)
        output_func = move_indexes_forward(self.parts, 1, 2)
        self.assertEqual(expected, output_func)

        expected = (4, 5)
        output_func = move_indexes_forward(self.parts, 1, 4)
        self.assertEqual(expected, output_func)

    def test_make_events(self):
        output_func = make_events(self.make_events_input_1)
        pd.testing.assert_frame_equal(self.make_events_expected_1, output_func)

        output_func = make_events(self.make_events_input_2)
        pd.testing.assert_frame_equal(self.make_events_expected_2, output_func)









